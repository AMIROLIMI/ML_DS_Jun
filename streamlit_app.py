import streamlit as st
import pandas as pd
import numpy as np
from sklearn.impute import SimpleImputer
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.neighbors import KNeighborsClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import roc_curve, auc
from mlxtend.plotting import plot_decision_regions



def load_data(url):
    data = pd.read_csv(url, header=None)
    data.columns = [f"A{i}" for i in range(1, 17)]
    return data


def preprocess_features(data):
    data = data.drop(columns=["A1", "A4", "A5", "A6", "A7", "A9", "A10", "A12", "A13"])
    data["A16"] = data["A16"].apply(lambda x: 1 if x == "+" else 0)
    st.dataframe(data["A16"].head(690))
    data.replace("?", np.nan, inplace=True)
    imputer = SimpleImputer(strategy='mean')
    data = pd.DataFrame(imputer.fit_transform(data), columns=data.columns)
    for col in ["A11", "A14", "A15", "A16"]:
        data[col] = data[col].astype(int)
    return data
    
def feature_selection(data):
    # 1. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ç–∞—Ä–≥–µ—Ç–æ–º (A16)
    correlation_with_target = data.drop(columns=["A16"]).corrwith(data["A16"]).sort_values(ascending=False)
    st.subheader("üîπ –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å —Ç–∞—Ä–≥–µ—Ç–æ–º (A16)")
    st.write(correlation_with_target)

    # 2. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∫–∞–∂–¥–æ–º –ø—Ä–∏–∑–Ω–∞–∫–µ
    unique_values_count = data.nunique()
    st.subheader("üîπ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∫–∞–∂–¥–æ–º –ø—Ä–∏–∑–Ω–∞–∫–µ")
    st.write(unique_values_count)

    # 3. –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å –±–æ–ª–µ–µ —á–µ–º 10 —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    significant_features = unique_values_count[unique_values_count > 10].index.tolist()
    significant_features_with_correlation = correlation_with_target[significant_features].sort_values(ascending=False)
    
    st.subheader("üîπ –¢—Ä–∏ –Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –±–æ–ª–µ–µ —á–µ–º 10 —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏")
    st.write(significant_features_with_correlation.head(3))
    st.dataframe(data["A16"].head(690))

    return significant_features_with_correlation.head(3).index.tolist()

def plot_3d_graph(data):
    st.subheader("üîπ –®–∞–≥ 5: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö")
    st.dataframe(data["A16"].head(690))
    st.markdown("""
    - üé® –ü–æ—Å—Ç—Ä–æ–π—Ç–µ 3D-–≥—Ä–∞—Ñ–∏–∫ —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è —Ä–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ –∏ –º–∞—Ä–∫–µ—Ä—ã –¥–ª—è –∫–ª–∞—Å—Å–æ–≤.
    - üè∑ –ü–æ–¥–ø–∏—à–∏—Ç–µ –æ—Å–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
    - üñº –î–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ª–µ–≥–µ–Ω–¥—É.
    """)
    
    # –°–æ–∑–¥–∞–µ–º 3D –≥—Ä–∞—Ñ–∏–∫
    fig = plt.figure(figsize=(10, 8))
    ax = fig.add_subplot(111, projection='3d')
    
    scatter = ax.scatter(data['A11'], data['A8'], data['A3'], c=data['A16'], marker='o', cmap='viridis')
    
    # –ü–æ–¥–ø–∏—Å—å –æ—Å–µ–π
    ax.set_xlabel('A11')
    ax.set_ylabel('A8')
    ax.set_zlabel('A3')
    
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫
    ax.set_title('3D-–≥—Ä–∞—Ñ–∏–∫ –¥–∞–Ω–Ω—ã—Ö: A3, A8, A11 (–ñ—ë–ª—Ç—ã–π —Ü–≤–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å.)')
    fig.colorbar(scatter, ax=ax, label='–ö–ª–∞—Å—Å (A16)')
    st.pyplot(fig)
    
def classification_models(data):
    X = data.drop(columns=["A16"])
    y = data["A16"]
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=11)
    st.dataframe(data["A16"].head(690))
    scaler = StandardScaler()
    X_train = scaler.fit_transform(X_train)
    X_test = scaler.transform(X_test)
    knc = KNeighborsClassifier(n_neighbors=3)
    log_reg = LogisticRegression(max_iter=565)
    dtc = DecisionTreeClassifier(max_depth = 5)
    st.subheader("üîπ –ú–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±—É—á–µ–Ω—ã")
    st.write("K-Nearest Neighbors, Logistic Regression, Decision Tree —É—Å–ø–µ—à–Ω–æ –æ–±—É—á–µ–Ω—ã –Ω–∞ –¥–∞–Ω–Ω—ã—Ö.")
    
    return knc, log_reg, dtc, X_train, X_test, y_train, y_test

def plot_decision_boundaries(X_train, y_train, knc, log_reg, dtc):
    X_train_np = np.array(X_train)[:, :2]
    y_train_np = np.array(y_train)
    
    knc.fit(X_train_np, y_train_np)
    log_reg.fit(X_train_np, y_train_np)
    dtc.fit(X_train_np, y_train_np)
    fig, axes = plt.subplots(1, 3, figsize=(18, 5))
    classifiers = [(knc, "K-Nearest Neighbors"), (log_reg, "Logistic Regression"), (dtc, "Decision Tree")]
    
    for idx, (clf, title) in enumerate(classifiers):
        plt.sca(axes[idx])  
        plot_decision_regions(X_train_np, y_train_np, clf=clf, legend=2)
        plt.xlabel("A2")
        plt.ylabel("A3")
        plt.title(title)
    
    plt.suptitle("–≥—Ä–∞–Ω–∏—Ü–∞ —Ä–µ—à–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ ", fontsize=14)
    plt.tight_layout(rect=[0, 0, 1, 0.95])
    plt.show()
    st.pyplot(plt)


def plot_roc_curves(knc, log_reg, dtc, X_test, y_test):
    y_score_knc = knc.predict_proba(X_test)[:, 1]
    y_score_log_reg = log_reg.predict_proba(X_test)[:, 1]
    y_score_dtc = dtc.predict_proba(X_test)[:, 1]
    fpr_knc, tpr_knc, _ = roc_curve(y_test, y_score_knc)
    fpr_log_reg, tpr_log_reg, _ = roc_curve(y_test, y_score_log_reg)
    fpr_dtc, tpr_dtc, _ = roc_curve(y_test, y_score_dtc)
    auc_knc = auc(fpr_knc, tpr_knc)
    auc_log_reg = auc(fpr_log_reg, tpr_log_reg)
    auc_dtc = auc(fpr_dtc, tpr_dtc)
    plt.plot(fpr_knc, tpr_knc, label=f'KNN (AUC = {auc_knc:.2f})', linestyle='-', color='blue')
    plt.plot(fpr_log_reg, tpr_log_reg, label=f'Logistic Regression (AUC = {auc_log_reg:.2f})', linestyle='-', color='orange')
    plt.plot(fpr_dtc, tpr_dtc, label=f'Decision Tree (AUC = {auc_dtc:.2f})', linestyle='-', color='green')
    plt.plot([0, 1], [0, 1], linestyle='--', color='gray')
    plt.xlabel('FPR')
    plt.ylabel('TPR')
    plt.title('ROC-–∫—Ä–∏–≤—ã–µ')
    plt.legend()
    plt.grid()
    plt.show()
    st.pyplot(plt)

def main():
    st.title("üìä –ê–Ω–∞–ª–∏–∑ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è UCI")
    st.subheader("üîπ –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö")
    st.markdown("""
    - –ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è UCI, –≤–∫–ª—é—á–∞—è —Å—Ç–æ–ª–±–µ—Ü —Å –º–µ—Ç–∫–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–º –∑–∞–¥–∞–Ω–∏–∏.
    """)
    
    url = st.text_input("–í–≤–µ–¥–∏—Ç–µ URL –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:", 
                       "https://raw.githubusercontent.com/AMIROLIMI/ML_DS_Jun/master/HW4-crx.data")
    
    if url:
        data = load_data(url)

        num_rows = st.slider("–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:", 
                             min_value=4, max_value=len(data), value=5)
        
        st.subheader("–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö")
        st.dataframe(data.head(num_rows))

        st.subheader("üîπ –®–∞–≥ 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Ç–æ–∫ –∫–ª–∞—Å—Å–æ–≤")
        st.markdown("""
        - üõ† –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–µ—Ç–∫–∞—Ö –∫–ª–∞—Å—Å–æ–≤, —É–¥–∞–ª–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏.
        - üîÑ –ï—Å–ª–∏ –∫–ª–∞—Å—Å–æ–≤ –±–æ–ª—å—à–µ –¥–≤—É—Ö, –æ–±—ä–µ–¥–∏–Ω–∏—Ç–µ –∏—Ö —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏–ª–∞—Å—å –±–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–º–µ—Ä–æ–≤.
        - ‚öñÔ∏è –ï—Å–ª–∏ –æ–¥–∏–Ω –∫–ª–∞—Å—Å –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç, –æ–±—ä–µ–¥–∏–Ω–∏—Ç–µ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤ –æ–¥–∏–Ω. –í—Å–µ–≥–æ –¥–æ–ª–∂–Ω–æ –æ—Å—Ç–∞—Ç—å—Å—è 2 –∫–ª–∞—Å—Å–∞ –≤ —Ç–∞—Ä–≥–µ—Ç–µ.
        """)
        
        st.subheader("üìâ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö")
        st.write(data.isna().sum())

        st.subheader("üî¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞–Ω–Ω—ã—Ö –¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏")
        st.text(data.info())

        st.subheader("–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–µ A16 –¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏")
        st.write(data["A16"].unique())
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Ç–æ–∫ –∫–ª–∞—Å—Å–æ–≤
        st.markdown(""" 
        –í —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –Ω–æ –µ—Å—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∫ "?". 
        –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –∏ –∑–∞–º–µ–Ω–µ–Ω—ã —Å—Ä–µ–¥–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏. –ê –∫–ª–∞—Å—Å–æ–≤ 2, –ø–æ —ç—Ç–æ–º—É –º–æ–∂–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å.
        """)
        data["A16"] = data["A16"].apply(lambda x: 1 if x == "+" else 0)
        
        st.markdown(""" 
        –ú—ã –∑–∞–º–µ–Ω–∏–ª–∏ —Å–∏–º–≤–æ–ª "+" –Ω–∞ 1 –∏ —Å–∏–º–≤–æ–ª "-" –Ω–∞ 0 –≤ —Å—Ç–æ–ª–±—Ü–µ A16.
        """)
        
        st.subheader("–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤")
        st.dataframe(data.head(num_rows))

        st.subheader("üîπ –®–∞–≥ 3: –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤")
        st.markdown("""
        - üî¢ –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ —á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω—ã.
        - üóë –£–¥–∞–ª–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (—Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è).
        - üìâ –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–æ–≤.
        """)
        st.markdown(""" 
        ### –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏–º —Ä–µ–∞–ª—å–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, —á—Ç–æ–±—ã –±—ã–ª–æ —É–¥–æ–±–Ω–æ:
        –ü–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ —É–¥–∞–ª—è—Ç—Å—è: ["A1", "A4", "A5", "A6", "A7", "A9", "A10", "A12", "A13"]
        
        –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞–º–µ–Ω–∏–º –≤—Å–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ "?" –Ω–∞ —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è.
        """)
        
        processed_data = preprocess_features(data)
        st.subheader("–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ")
        st.dataframe(processed_data.head(num_rows))
        
        st.subheader("üî¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏")
        st.text(processed_data.info())
        
        st.subheader("üìâ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö")
        st.write(processed_data.isna().sum())

        csv = processed_data.to_csv(index=False)
        st.download_button("–°–∫–∞—á–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", csv, "processed_data.csv", "text/csv")

        # –®–∞–≥ 4: –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
        st.subheader("üîπ –®–∞–≥ 4: –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤")
        st.markdown("""
        - üîç –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–∏ –Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –±–æ–ª–µ–µ 10 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å —Ç–∞—Ä–≥–µ—Ç–æ–º.
        - –ú—ã –≤—ã—á–∏—Å–ª–∏–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (A16) –∏ –≤—ã–±–µ—Ä–µ–º —Ç—Ä–∏ –Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã—Ö.
        - –ü—Ä–∏–∑–Ω–∞–∫–∏ —Å –±–æ–ª–µ–µ —á–µ–º 10 —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–Ω—ã –ø–æ –Ω–∞–∏–±–æ–ª—å—à–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.
        """)
        
        st.dataframe(data.head(num_rows))

        # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–Ω–∞—á–∏–º—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
        significant_features = feature_selection(processed_data)
        st.subheader("üîπ –¢—Ä–∏ –Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:")
        st.write(significant_features)
        # —à–∞–≥ 5
        plot_3d_graph(processed_data)
        st.subheader("üîπ –®–∞–≥ 6: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è")
        knc, log_reg, dtc, X_train, X_test, y_train, y_test = classification_models(processed_data)
        st.subheader("üîπ –®–∞–≥ 7: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞–Ω–∏—Ü —Ä–µ—à–µ–Ω–∏–π")
        plot_decision_boundaries(X_train, y_train, knc, log_reg, dtc)
        st.subheader("üîπ –®–∞–≥ 8: ROC-–∫—Ä–∏–≤—ã–µ") 
        plot_roc_curves(knc, log_reg, dtc, X_test, y_test)

if __name__ == "__main__":
    main()
